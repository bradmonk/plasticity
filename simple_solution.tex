\documentclass[a4paper,10pt]{article}

\usepackage[margin=1in]{geometry}
\usepackage{amsmath,amsthm,amssymb,hyperref,tikz}
%% For subfigure
\usepackage{caption,subcaption,graphicx}

\hypersetup{colorlinks=true,urlcolor=blue}

\usepackage{embedfile,fancyvrb}
\embedfile{\jobname.tex}

\usepackage{fancyhdr}
\pagestyle{fancy}
\lhead{Danny Hermes}
\rhead{Brad Poopy Head}

\renewcommand{\headrulewidth}{0pt}

\begin{document}

\textbf{NOTE:} To extract the \LaTeX\ source of this PDF and the supporting
files, execute:
\begin{Verbatim}[commandchars=\\\{\}]
pdftk \jobname.pdf unpack_files output .
\end{Verbatim}

\section{Initial Formulation}
The forward \textbf{Kolmogorov forward equation (diffusion)} or more
commonly known as the
\href{http://en.wikipedia.org/wiki/Fokker\%E2\%80\%93Planck_equation\#Many_dimensions}{Fokker-Planck equation}
describes a process which dictates the time evolution of the probability
density function for a random process.

We have a two-dimensional random process
\[\mathbf{X}_t = \left[ \begin{array}{c} X_t \\
Y_t \end{array}\right]\]
which diffuses via a Wiener/Brownian motion \(\mathbf{W}_t\). This diffusion
has no drift but has a piecewise constant diffusion rate in both space
directions, parameterized by the following region:
\begin{center}
\begin{tikzpicture}[scale=0.75]
\draw (0, 0) -- (0, 10);
\draw (0, 10) -- (10, 10);
\draw (0, 0) -- (10, 0);
\draw (10, 0) -- (10, 10);

\draw (4.5, 4.5) -- (4.5, 5.5);
\draw (4.5, 4.5) -- (5.5, 4.5);
\draw (4.5, 5.5) -- (5.5, 5.5);
\draw (5.5, 4.5) -- (5.5, 5.5);

\draw (0, -0.5) node{\scriptsize{\((0, 0)\)}};
\draw (10, -0.5) node{\scriptsize{\((10, 0)\)}};
\draw (10, 10.5) node{\scriptsize{\((10, 10)\)}};
\draw (0, 10.5) node{\scriptsize{\((0, 10)\)}};

\draw (4, 4) node{\scriptsize{\((4.5, 5.5)\)}};
\draw (6, 4) node{\scriptsize{\((5.5, 4.5)\)}};
\draw (4, 6) node{\scriptsize{\((4.5, 5.5)\)}};
\draw (6, 6) node{\scriptsize{\((5.5, 5.5)\)}};
\end{tikzpicture}
\end{center}

Given this description, the distribution satisfies the stochastic process
\[d\mathbf{X}_t = \boldsymbol{\sigma}\left(\mathbf{X}_t, t\right) d
\mathbf{W}_t\]
where the diffusion is given by
\[\boldsymbol{\sigma}\left(\mathbf{X}_t, t\right) = \left[ \begin{array}{c c}
\sigma\left(\mathbf{X}_t, t\right) & 0 \\
0 & \sigma\left(\mathbf{X}_t, t\right)  \end{array}\right]\]
and the scalar piecewise diffusion \(\sigma\left(\mathbf{X}_t, t\right)\) is
given by
\[\sigma \left(\mathbf{X}_t, t\right) = a + (b - a) \cdot \chi
\left(\mathbf{X}_t\right)\]
(note this does not depend on time, only on position \(\mathbf{X}_t\)). In
the above
\begin{itemize}
\item \(\chi\) is the indicator function for the small region in
the middle \(4.5 \leq x, y \leq 5.5\)
\item \(a\) is the constant diffusion rate in the large region
\item \(b\) is the constant diffusion rate in the small region
\end{itemize}

\section{Defining the PDE}
Letting \(f(\mathbf{x}, t)\) be the probability density function for
\(\mathbf{x} \in \left[0, 10\right] \times \left[0, 10\right]\), the theory
gives us a PDE from the stochastic process defined above.

To define the PDE, we need to compute the diffusion tensors
\[D_{ij}(\mathbf{x}, t) = \sum_{k = 1}^2 \sigma_{ik}(\mathbf{x}, t)
\sigma_{jk}(\mathbf{x}, t)\]
for \(i, j \in \left\{1, 2\right\}\). Since \(\sigma_{12} = \sigma_{21} = 0\)
the quantities are only non-zero if \(i = j\). In either case
\[D_{11}(\mathbf{x}, t) = D_{22}(\mathbf{x}, t) =
\sigma \left(\mathbf{x}, t\right)^2 = \sigma \left(\mathbf{x}\right)^2\]
(we recall from above that \(\sigma\) does not depend on time).
Given this, the PDE is
\[\boxed{\frac{\partial f}{\partial t} = \frac{1}{2} \sum_{i = 1}^2
\sum_{j = 1}^2 \frac{\partial^2}{\partial x_i \, \partial x_j}
\left[D_{ij} \cdot f\right] = \frac{1}{2} \left[
\frac{\partial^2}{\partial x^2}
\left[D_{11} \cdot f\right] + \frac{\partial^2}{\partial y^2}
\left[D_{22} \cdot f\right]\right]}.\]
Since \(D_{11} = D_{22}\) we recognize this as the
\href{http://en.wikipedia.org/wiki/Laplace_operator}{Laplace operator}
\[\frac{\partial f}{\partial t} = \frac{1}{2} \nabla^2
\left[\sigma \left(\mathbf{x}\right)^2 \cdot f\right].\]

\section{Determining the Steady State}
We seek to find the equilibrium (or steady state) behavior of this system.
In other words we seek to find the density function:
\[g(\mathbf{x}) = \lim_{t \to \infty} f(\mathbf{x}, t)\]
defined over the region. Passing to the limit in our PDE above and
utilizing the fact that \(\sigma\) does not depend on time, this gives
\[0 = \frac{1}{2} \nabla^2 \left[\sigma \left(\mathbf{x}\right)^2
\cdot g\right].\]
\end{document}
